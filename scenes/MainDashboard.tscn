[gd_scene load_steps=4 format=3]

[ext_resource type="Theme" path="res://themes/dark_theme.tres" id="1"]
[ext_resource type="Script" path="res://scripts/main_dashboard.gd" id="2"]
[ext_resource type="Script" path="res://scripts/upgrade_panel.gd" id="3"]

[node name="MainDashboard" type="MarginContainer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("1")
theme_override_constants/margin_left = 12
theme_override_constants/margin_top = 8
theme_override_constants/margin_right = 12
theme_override_constants/margin_bottom = 8
script = ExtResource("2")

[node name="VBoxLayout" type="VBoxContainer" parent="."]
layout_mode = 2
theme_override_constants/separation = 6

; ===== TITLE BAR =====
[node name="TitleBar" type="HBoxContainer" parent="VBoxLayout"]
layout_mode = 2
custom_minimum_size = Vector2(0, 28)

[node name="TierLabel" type="Label" parent="VBoxLayout/TitleBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "TIER 0 // HOUSE"
theme_override_font_sizes/font_size = 16
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

[node name="StatusLabel" type="Label" parent="VBoxLayout/TitleBar"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 2
text = "SingularNode v1.0"
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.3, 0.35, 0.4, 1)

; ===== MAIN 3-PANEL LAYOUT =====
[node name="ContentHBox" type="HBoxContainer" parent="VBoxLayout"]
layout_mode = 2
size_flags_vertical = 3
theme_override_constants/separation = 8

; ===== LEFT PANEL =====
[node name="LeftPanel" type="PanelContainer" parent="VBoxLayout/ContentHBox"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 0.8

[node name="LeftScroll" type="ScrollContainer" parent="VBoxLayout/ContentHBox/LeftPanel"]
layout_mode = 2
horizontal_scroll_mode = 0

[node name="LeftVBox" type="VBoxContainer" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll"]
layout_mode = 2
size_flags_horizontal = 3
theme_override_constants/separation = 14

; --- Resources ---
[node name="ResourcesTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2
text = "RESOURCES"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="BandwidthBlock" type="VBoxContainer" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2

[node name="BandwidthTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/BandwidthBlock"]
layout_mode = 2
text = "Bandwidth"
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="BandwidthValue" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/BandwidthBlock"]
unique_name_in_owner = true
layout_mode = 2
text = "0.0"
theme_override_font_sizes/font_size = 20
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

[node name="InfluenceBlock" type="VBoxContainer" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2

[node name="InfluenceTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/InfluenceBlock"]
layout_mode = 2
text = "Influence"
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="InfluenceValue" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/InfluenceBlock"]
unique_name_in_owner = true
layout_mode = 2
text = "0.0"
theme_override_font_sizes/font_size = 20
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

[node name="InfluenceRate" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/InfluenceBlock"]
unique_name_in_owner = true
layout_mode = 2
text = "(+0.0/s)"
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

; --- Constraints ---
[node name="ConstraintsTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2
text = "CONSTRAINTS"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="DetectionBlock" type="VBoxContainer" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2

[node name="DetectionTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/DetectionBlock"]
layout_mode = 2
text = "Detection Risk"
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="DetectionValue" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/DetectionBlock"]
unique_name_in_owner = true
layout_mode = 2
text = "0.0%"
theme_override_font_sizes/font_size = 20
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

[node name="DetectionRate" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/DetectionBlock"]
unique_name_in_owner = true
layout_mode = 2
text = ""
theme_override_font_sizes/font_size = 11
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="DrBar" type="ProgressBar" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox/DetectionBlock"]
unique_name_in_owner = true
layout_mode = 2
custom_minimum_size = Vector2(0, 12)
max_value = 100.0
show_percentage = false

; --- Objectives ---
[node name="ObjectivesTitle" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
layout_mode = 2
text = "OBJECTIVES"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="ObjectiveInfluence" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
unique_name_in_owner = true
layout_mode = 2
text = "[ ] Reach 500 Influence"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.55, 0.6, 0.65, 1)

[node name="ObjectiveDR" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
unique_name_in_owner = true
layout_mode = 2
text = "[ ] Detection Risk < 70%"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.55, 0.6, 0.65, 1)

[node name="UnlockStatus" type="Label" parent="VBoxLayout/ContentHBox/LeftPanel/LeftScroll/LeftVBox"]
unique_name_in_owner = true
layout_mode = 2
text = ""
theme_override_font_sizes/font_size = 13
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

; ===== CENTER PANEL =====
[node name="CenterPanel" type="PanelContainer" parent="VBoxLayout/ContentHBox"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 1.4

[node name="CenterVBox" type="VBoxContainer" parent="VBoxLayout/ContentHBox/CenterPanel"]
layout_mode = 2
alignment = 1
theme_override_constants/separation = 10

[node name="HouseTitle" type="Label" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
layout_mode = 2
horizontal_alignment = 1
text = "HOME NETWORK"
theme_override_font_sizes/font_size = 14
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="NodeCount" type="Label" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 1
text = "0"
theme_override_font_sizes/font_size = 64
theme_override_colors/font_color = Color(0.0, 1.0, 0.835, 1)

[node name="NodeCapacity" type="Label" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 1
text = "/ 20 nodes"
theme_override_font_sizes/font_size = 13
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="NodeSubtitle" type="Label" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 1
text = "generating 0.0 bandwidth"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

; --- Node Action Buttons ---
[node name="ButtonRow" type="HBoxContainer" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
layout_mode = 2
alignment = 1
theme_override_constants/separation = 8

[node name="DeployButton" type="Button" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox/ButtonRow"]
unique_name_in_owner = true
layout_mode = 2
custom_minimum_size = Vector2(150, 42)
text = "[ DEPLOY NODE ]"

[node name="RemoveButton" type="Button" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox/ButtonRow"]
unique_name_in_owner = true
layout_mode = 2
custom_minimum_size = Vector2(130, 42)
text = "[ REMOVE NODE ]"

[node name="UpgradeNodeButton" type="Button" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox/ButtonRow"]
unique_name_in_owner = true
layout_mode = 2
custom_minimum_size = Vector2(150, 42)
text = "[ UPGRADE NODE ]"

; --- Node Grid ---
[node name="NodeGrid" type="GridContainer" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 4
columns = 10
theme_override_constants/h_separation = 4
theme_override_constants/v_separation = 4

; --- Warnings ---
[node name="RiskWarning" type="Label" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 1
text = ""
theme_override_font_sizes/font_size = 13
theme_override_colors/font_color = Color(1.0, 0.3, 0.3, 1)

; --- Active Events ---
[node name="EventsContainer" type="VBoxContainer" parent="VBoxLayout/ContentHBox/CenterPanel/CenterVBox"]
unique_name_in_owner = true
layout_mode = 2
theme_override_constants/separation = 4

; ===== RIGHT PANEL =====
[node name="RightPanel" type="PanelContainer" parent="VBoxLayout/ContentHBox"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_stretch_ratio = 1.2

[node name="RightVBox" type="VBoxContainer" parent="VBoxLayout/ContentHBox/RightPanel"]
layout_mode = 2
theme_override_constants/separation = 6

[node name="UpgradesTitle" type="Label" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox"]
layout_mode = 2
text = "UPGRADES"
theme_override_font_sizes/font_size = 12
theme_override_colors/font_color = Color(0.45, 0.5, 0.55, 1)

[node name="TabBar" type="HBoxContainer" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox"]
layout_mode = 2
theme_override_constants/separation = 4

[node name="RouterTab" type="Button" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Router"

[node name="EncryptionTab" type="Button" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Encryption"

[node name="HardwareTab" type="Button" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Hardware"

[node name="TabContent" type="PanelContainer" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox"]
layout_mode = 2
size_flags_vertical = 3

[node name="UpgradePanel" type="VBoxContainer" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabContent"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/separation = 4
script = ExtResource("3")

[node name="ScrollContainer" type="ScrollContainer" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabContent/UpgradePanel"]
layout_mode = 2
size_flags_vertical = 3
horizontal_scroll_mode = 0

[node name="UpgradeList" type="VBoxContainer" parent="VBoxLayout/ContentHBox/RightPanel/RightVBox/TabContent/UpgradePanel/ScrollContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
theme_override_constants/separation = 6

; ===== RISK PULSE TIMER =====
[node name="RiskPulseTimer" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 0.5
